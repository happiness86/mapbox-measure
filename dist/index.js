!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MapboxMeasure=t():e.MapboxMeasure=t()}(this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";function n(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function o(e,t,r){return void 0===r&&(r={}),n({type:"Point",coordinates:e},t,r)}function i(e,t,r){void 0===r&&(r={});for(var o=0,i=e;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t,r)}function a(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:e},t,r)}function s(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function u(e,t,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:e},t,r)}function c(e,t,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:e},t,r)}function l(e,t,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:e},t,r)}function d(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function g(e){return 180*(e%(2*Math.PI))/Math.PI}function h(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=n,t.geometry=function(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return o(t).geometry;case"LineString":return a(t).geometry;case"Polygon":return i(t).geometry;case"MultiPoint":return c(t).geometry;case"MultiLineString":return u(t).geometry;case"MultiPolygon":return l(t).geometry;default:throw new Error(e+" is invalid")}},t.point=o,t.points=function(e,t,r){return void 0===r&&(r={}),s(e.map((function(e){return o(e,t)})),r)},t.polygon=i,t.polygons=function(e,t,r){return void 0===r&&(r={}),s(e.map((function(e){return i(e,t)})),r)},t.lineString=a,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),s(e.map((function(e){return a(e,t)})),r)},t.featureCollection=s,t.multiLineString=u,t.multiPoint=c,t.multiPolygon=l,t.geometryCollection=function(e,t,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:e},t,r)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=d,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return g(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=g,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return d(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[r];if(!o)throw new Error("invalid original units");var i=t.areaFactors[n];if(!i)throw new Error("invalid final units");return e/o*i},t.isNumber=h,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!h(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);function o(e,t,r){if(null!==e)for(var n,i,a,s,u,c,l,d,f=0,g=0,h=e.type,p="FeatureCollection"===h,m="Feature"===h,y=p?e.features.length:1,v=0;v<y;v++){u=(d=!!(l=p?e.features[v].geometry:m?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var _=0;_<u;_++){var b=0,w=0;if(null!==(s=d?l.geometries[_]:l)){c=s.coordinates;var M=s.type;switch(f=!r||"Polygon"!==M&&"MultiPolygon"!==M?0:1,M){case null:break;case"Point":if(!1===t(c,g,v,b,w))return!1;g++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(!1===t(c[n],g,v,b,w))return!1;g++,"MultiPoint"===M&&b++}"LineString"===M&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-f;i++){if(!1===t(c[n][i],g,v,b,w))return!1;g++}"MultiLineString"===M&&b++,"Polygon"===M&&w++}"Polygon"===M&&b++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(w=0,i=0;i<c[n].length;i++){for(a=0;a<c[n][i].length-f;a++){if(!1===t(c[n][i][a],g,v,b,w))return!1;g++}w++}b++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===o(s.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function a(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function s(e,t){var r,n,o,i,a,s,u,c,l,d,f=0,g="FeatureCollection"===e.type,h="Feature"===e.type,p=g?e.features.length:1;for(r=0;r<p;r++){for(s=g?e.features[r].geometry:h?e.geometry:e,c=g?e.features[r].properties:h?e.properties:{},l=g?e.features[r].bbox:h?e.bbox:void 0,d=g?e.features[r].id:h?e.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,f,c,l,d))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===t(i.geometries[n],f,c,l,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,f,c,l,d))return!1;f++}}function u(e,t){s(e,(function(e,r,o,i,a){var s,u=null===e?null:e.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==t(n.feature(e,o,{bbox:i,id:a}),r,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var c=0;c<e.coordinates.length;c++){var l={type:s,coordinates:e.coordinates[c]};if(!1===t(n.feature(l,o),r,c))return!1}}))}function c(e,t){u(e,(function(e,r,i){var a=0;if(e.geometry){var s=e.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var u,c=0,l=0,d=0;return!1!==o(e,(function(o,s,f,g,h){if(void 0===u||r>c||g>l||h>d)return u=o,c=r,l=g,d=h,void(a=0);var p=n.lineString([u,o],e.properties);if(!1===t(p,r,i,h,a))return!1;a++,u=o}))&&void 0}}}))}function l(e,t){if(!e)throw new Error("geojson is required");u(e,(function(e,r,o){if(null!==e.geometry){var i=e.geometry.type,a=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,r,o,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===t(n.lineString(a[s],e.properties),r,o,s))return!1}}}))}t.coordEach=o,t.coordReduce=function(e,t,r,n){var i=r;return o(e,(function(e,n,o,a,s){i=0===n&&void 0===r?e:t(i,e,n,o,a,s)}),n),i},t.propEach=i,t.propReduce=function(e,t,r){var n=r;return i(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n},t.featureEach=a,t.featureReduce=function(e,t,r){var n=r;return a(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n},t.coordAll=function(e){var t=[];return o(e,(function(e){t.push(e)})),t},t.geomEach=s,t.geomReduce=function(e,t,r){var n=r;return s(e,(function(e,o,i,a,s){n=0===o&&void 0===r?e:t(n,e,o,i,a,s)})),n},t.flattenEach=u,t.flattenReduce=function(e,t,r){var n=r;return u(e,(function(e,o,i){n=0===o&&0===i&&void 0===r?e:t(n,e,o,i)})),n},t.segmentEach=c,t.segmentReduce=function(e,t,r){var n=r,o=!1;return c(e,(function(e,i,a,s,u){n=!1===o&&void 0===r?e:t(n,e,i,a,s,u),o=!0})),n},t.lineEach=l,t.lineReduce=function(e,t,r){var n=r;return l(e,(function(e,o,i,a){n=0===o&&void 0===r?e:t(n,e,o,i,a)})),n},t.findSegment=function(e,t){if(t=t||{},!n.isObject(t))throw new Error("options is invalid");var r,o=t.featureIndex||0,i=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.segmentIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o),u=u||e.features[o].properties,r=e.features[o].geometry;break;case"Feature":u=u||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=c.length+s-1),n.lineString([c[s],c[s+1]],u,t);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s-1),n.lineString([c[a][s],c[a][s+1]],u,t);case"MultiLineString":return i<0&&(i=c.length+i),s<0&&(s=c[i].length+s-1),n.lineString([c[i][s],c[i][s+1]],u,t);case"MultiPolygon":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),s<0&&(s=c[i][a].length-s-1),n.lineString([c[i][a][s],c[i][a][s+1]],u,t)}throw new Error("geojson is invalid")},t.findPoint=function(e,t){if(t=t||{},!n.isObject(t))throw new Error("options is invalid");var r,o=t.featureIndex||0,i=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.coordIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o),u=u||e.features[o].properties,r=e.features[o].geometry;break;case"Feature":u=u||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":return n.point(c,u,t);case"MultiPoint":return i<0&&(i=c.length+i),n.point(c[i],u,t);case"LineString":return s<0&&(s=c.length+s),n.point(c[s],u,t);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s),n.point(c[a][s],u,t);case"MultiLineString":return i<0&&(i=c.length+i),s<0&&(s=c[i].length+s),n.point(c[i][s],u,t);case"MultiPolygon":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),s<0&&(s=c[i][a].length-s),n.point(c[i][a][s],u,t)}throw new Error("geojson is invalid")}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(5)),i=r(1);t.default=function(e,t){return void 0===t&&(t={}),i.segmentReduce(e,(function(e,r){var n=r.geometry.coordinates;return e+o.default(n[0],n[1],t)}),0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);function o(e){var t=0;if(e&&e.length>0){t+=Math.abs(i(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(i(e[r]))}return t}function i(e){var t,r,n,o,i,s,u=0,c=e.length;if(c>2){for(s=0;s<c;s++)s===c-2?(n=c-2,o=c-1,i=0):s===c-1?(n=c-1,o=0,i=1):(n=s,o=s+1,i=s+2),t=e[n],r=e[o],u+=(a(e[i][0])-a(t[0]))*Math.sin(a(r[1]));u=6378137*u*6378137/2}return u}function a(e){return e*Math.PI/180}t.default=function(e){return n.geomReduce(e,(function(e,t){return e+function(e){var t,r=0;switch(e.type){case"Polygon":return o(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=o(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c}));var n=r(2),o=r.n(n),i=r(3),a=r.n(i);r(7);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"options",{lengthUnit:"kilometers"}),u(this,"geoData",{type:"FeatureCollection",features:[]}),u(this,"lineStringData",{type:"Feature",geometry:{type:"LineString",coordinates:[]}}),u(this,"polygonData",{type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}}),u(this,"result",{totalLength:0,totalArea:0}),u(this,"isMeasuring",!1),Object.assign({},this.options,t)}var t,r,n;return t=e,(r=[{key:"onAdd",value:function(e){return this._map=e,this._container=document.createElement("div"),this._container.classList.add("mapboxgl-ctrl"),this._container.classList.add("__measure__"),this._container.appendChild(this._createOperatorWrapper()),this._addMeasureLayers(),this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0,this.isMeasuring=!1,this.result=null,this.geoData=null,this.lineStringData=null,this.polygonData=null}},{key:"getDefaultPosition",value:function(){return"bottom-right"}},{key:"_createResultContainer",value:function(){var e=document.createElement("div");return e.classList.add("__measure__result__container"),this._retContainer=e,[{label:"路径长度",value:this.result.totalLength,className:"__measure__length",unit:"kilometers"===this.options.lengthUnit?"千米":"英里"},{label:"面积",value:this.result.totalArea,className:"__measure__area",unit:"平方米"}].forEach((function(t){var r=document.createElement("div");r.classList.add("__measure__result");var n=document.createElement("span");n.innerText=t.label;var o=document.createElement("span");o.classList.add(t.className),o.innerText=t.value.toLocaleString();var i=document.createElement("span");i.innerText=t.unit,r.append(n,o,i),e.appendChild(r)})),e}},{key:"_createMeasureBtn",value:function(){function e(){r.classList.toggle("__btn__hidden",t.isMeasuring),i.classList.toggle("__btn__hidden",!t.isMeasuring)}var t=this,r=document.createElement("button");r.classList.add("__measure__btn"),r.classList.add("__measure__start_btn"),r.innerText="开始一次新的测量",r.onclick=function(r){t.cancelMeasure(),t.handleMapClick(),e()};var n=document.createElement("button");n.classList.add("__measure__btn"),n.classList.add("__measure__cancel_btn"),n.innerText="取消测量",n.onclick=function(r){t.cancelMeasure(),e()};var o=document.createElement("button");o.classList.add("__measure__btn"),o.classList.add("__measure__end_btn"),o.innerText="完成测量",o.onclick=function(r){t.measureDone(),e()};var i=document.createElement("div");return i.classList.add("__btn__wrapper"),i.appendChild(n),i.appendChild(o),e(),{startBtn:r,wrapper:i}}},{key:"_createOperatorWrapper",value:function(){var e=document.createDocumentFragment(),t=document.createElement("h3");t.innerText="同时测量距离和面积";var r=this._createResultContainer(),n=this._createMeasureBtn();return e.append(t,r,n.startBtn,n.wrapper),e}},{key:"_createPopupDom",value:function(e){var t=document.createElement("div");t.classList.add("__measure__popup");var r=document.createElement("h3");r.innerText="测量结果";var n=this._createResultContainer(),o=document.createElement("div");return o.classList.add("__measure__popup__del"),o.innerText="删除",e&&(o.onclick=e),t.append(r,n,o),t}},{key:"_addMeasureLayers",value:function(){this._map.addSource("geoData",{type:"geojson",data:this.geoData}),this._map.addLayer({id:"measurePoint",type:"circle",source:"geoData",paint:{"circle-color":"#1B81FF","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#1B81FF"},filter:["in","$type","Point"]}),this._map.addLayer({id:"measureLine",type:"line",source:"geoData",paint:{"line-color":"#1B81FF","line-width":2},filter:["in","$type","LineString"]}),this._map.addLayer({id:"measurePolygon",type:"fill",source:"geoData",paint:{"fill-color":"#1B81FF","fill-outline-color":"#1B81FF","fill-opacity":.3},filter:["in","$type","Polygon"]}),this.handleLayerClick(["measurePoint","measurePolygon","measureLine"])}},{key:"handleLayerClick",value:function(e){var t=this,r=this;e.forEach((function(e){t._map.on("click",e,(function(e){if(!r.isMeasuring)var t=r._createPopupDom((function(){r.cancelMeasure(),n.remove()})),n=(new mapboxgl.Popup).setLngLat(e.lngLat).setDOMContent(t).addTo(r._map)}))}))}},{key:"handleMapClick",value:function(){var e=this;this.isMeasuring=!0,this._map.on("click",(function(t){if(e.isMeasuring){var r=e._map.queryRenderedFeatures(t.point,{layers:["measurePoint"]});if(e._removeGeometry(["LineString","Polygon"]),r.length){var n=r[0].properties.id;e.geoData.features=e.geoData.features.filter((function(e){return e.properties.id!==n}))}else e.geoData.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.lngLat.lng,t.lngLat.lat]},properties:{id:Date.now().toString()}});e.getLineString(!1),e.geoData.features.length>3&&(e.polygonData.geometry.coordinates[0]=[],e.geoData.features.forEach((function(t){"Point"===t.geometry.type&&e.polygonData.geometry.coordinates[0].push(t.geometry.coordinates)})),e.polygonData.geometry.coordinates[0].push(e.geoData.features[0].geometry.coordinates),e.geoData.features.push(e.polygonData),e.result.totalArea=a()(e.polygonData),e.calcArea(e.result.totalArea)),e._map.getSource("geoData").setData(e.geoData)}}))}},{key:"cancelMeasure",value:function(){this.isMeasuring=!1,this.geoData.features=[],this._map.getSource("geoData").setData(this.geoData),this.calcArea(0),this.calcLength(0)}},{key:"measureDone",value:function(){this.isMeasuring=!1,this._removeGeometry(["LineString"]),this.getLineString(!0),this._map.getSource("geoData").setData(this.geoData)}},{key:"_removeGeometry",value:function(e){for(var t=this.geoData.features.length;t--;){var r=this.geoData.features[t];e.includes(r.geometry.type)&&this.geoData.features.splice(t,1)}}},{key:"getLineString",value:function(e){var t=this.geoData.features;if(t.length>1){var r=[];t.forEach((function(e){"Point"===e.geometry.type&&r.push(e.geometry.coordinates)})),this.lineStringData.geometry.coordinates=r,e&&this.lineStringData.geometry.coordinates.push(t[0].geometry.coordinates),t.push(this.lineStringData),this.result.totalLength=o()(this.lineStringData),this.calcLength(this.result.totalLength)}}},{key:"calcLength",value:function(e){this._container.querySelector(".__measure__length").innerText=e.toLocaleString()}},{key:"calcArea",value:function(e){this._container.querySelector(".__measure__area").innerText=e.toLocaleString()}}])&&s(t.prototype,r),n&&s(t,n),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(0);t.default=function(e,t,r){void 0===r&&(r={});var i=n.getCoord(e),a=n.getCoord(t),s=o.degreesToRadians(a[1]-i[1]),u=o.degreesToRadians(a[0]-i[0]),c=o.degreesToRadians(i[1]),l=o.degreesToRadians(a[1]),d=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(c)*Math.cos(l);return o.radiansToLength(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),r.units)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.getCoord=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},t.getCoords=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},t.containsNumber=function e(t){if(t.length>1&&n.isNumber(t[0])&&n.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},t.geojsonType=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)},t.featureOf=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)},t.collectionOf=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=e.features;n<o.length;n++){var i=o[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+i.geometry.type)}},t.getGeom=function(e){return"Feature"===e.type?e.geometry:e},t.getType=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}},function(e,t,r){var n=r(8),o=r(9);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},function(e,t,r){"use strict";var n,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),a=[];function s(e){for(var t=-1,r=0;r<a.length;r++)if(a[r].identifier===e){t=r;break}return t}function u(e,t){for(var r={},n=[],o=0;o<e.length;o++){var i=e[o],u=t.base?i[0]+t.base:i[0],c=r[u]||0,l="".concat(u," ").concat(c);r[u]=c+1;var d=s(l),f={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(a[d].references++,a[d].updater(f)):a.push({identifier:l,updater:m(f,t),references:1}),n.push(l)}return n}function c(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var o=r.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function f(e,t,r,n){var o=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=d(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function g(e,t,r){var n=r.css,o=r.media,i=r.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var h=null,p=0;function m(e,t){var r,n,o;if(t.singleton){var i=p++;r=h||(h=c(t)),n=f.bind(null,r,i,!1),o=f.bind(null,r,i,!0)}else r=c(t),n=g.bind(null,r,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var r=u(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var o=s(r[n]);a[o].references--}for(var i=u(e,t),c=0;c<r.length;c++){var l=s(r[c]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}r=i}}}},function(e,t,r){(t=r(10)(!1)).push([e.i,".__measure__ {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\tpadding: 8px 8px;\n\tfont-size: 14px;\n\tborder-radius: 4px;\n\tmin-width: 300px;\n\tmin-height: 160px;\n\tbackground: #fff;\n}\n\n.__measure__ h3 {\n\tfont-size: 16px;\n\tpadding-bottom: 8px;\n\tborder-bottom: 1px solid #eee;\n}\n\n.__measure__result__container .__measure__result{\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 10px 0;\n}\n.__measure__result__container .__measure__result span:first-child {\n\tcolor: #999999;\n\tmargin-right: 4px;\n}\n\n.__measure__ .__measure__btn {\n\tdisplay: block;\n\tbackground-color: #409EFF;\n\tcursor: pointer;\n\tpadding: 4px 10px;\n\tborder: none;\n\tborder-radius: 2px;\n\tcolor: #ffffff;\n\toutline: none;\n}\n.__measure__ .__measure__btn:hover {\n\tbackground-color: #409EFF!important;\n}\n.__measure__ .__measure__start_btn {\n\tmargin: 10px auto 0;\n\twidth: 160px;\n}\n.__measure__ .__btn__wrapper {\n\tdisplay: flex;\n\tmargin-top: 10px;\n\tjustify-content: center;\n}\n.__measure__  .__btn__hidden {\n\tdisplay: none;\n}\n.__measure__ .__btn__wrapper .__measure__cancel_btn {\n\tmargin-right: 10px;\n}\n\n.__measure__popup {\n\tpadding: 10px;\n}\n.__measure__popup .__measure__popup__del {\n\ttext-align: right;\n\tcursor: pointer;\n\tcolor: #409EFF;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var o=(a=n,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[r].concat(i).concat([o]).join("\n")}var a,s,u;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);n&&o[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),t.push(u))}},t}}]).default}));